<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
    </style>
</head>
<body>
    <div class="goods">
        <div class="item">商品0<button class="add">add</button><button class="minus">minus</button></div>
        <div class="item">商品1<button class="add">add</button><button class="minus">minus</button></div>
        <div class="item">商品2<button class="add">add</button><button class="minus">minus</button></div>
        <div class="item">商品3<button class="add">add</button><button class="minus">minus</button></div>
        <div class="item">商品4<button class="add">add</button><button class="minus">minus</button></div>
        <div class="item">商品5<button class="add">add</button><button class="minus">minus</button></div>
        <div class="item">商品6<button class="add">add</button><button class="minus">minus</button></div>
        <div class="item">商品7<button class="add">add</button><button class="minus">minus</button></div>
        <div class="item">商品8<button class="add">add</button><button class="minus">minus</button></div>
        <div class="item">商品9<button class="add">add</button><button class="minus">minus</button></div>
    </div><br/>
    <div id="gouwuc">购物车






    </div>
    <script>
        var addbtns=document.querySelectorAll(".goods>.item>.add")
        var minusbtns=document.querySelectorAll(".goods>.item>.minus")
        for(let i=0;i<addbtns.length;i++){
            updateStorage(i)

        }
        function updateStorage(i){
            var buyCar=document.getElementById("gouwuc")
            if(localStorage.getItem('buy['+i+']')==null) return;
            else if(localStorage.getItem('buy['+i+']')==0){
                if(document.getElementById("produc"+i.toString()))
                    buyCar.removeChild(document.getElementById("produc"+i.toString()))
            }
            else if(document.getElementById("produc"+i.toString())==null){
                var newProdc = newProductStore(i)
                newProdc.innerHTML="商品"+i.toString()+"数量"+localStorage.getItem('buy['+i+']')
                buyCar.appendChild(newProdc)
                }
            else{
                newProdc=document.getElementById("produc"+i.toString())
                newProdc.innerHTML="商品"+i.toString()+"数量"+localStorage.getItem('buy['+i+']')
                console.log("storage")
            }


        }
        function newProductStore(i){
            var newPS=document.createElement("div")
            newPS.setAttribute("id","produc"+i.toString())
            return newPS
        }

        for(let i=0;i<addbtns.length;i++){
            addbtns[i].addEventListener("click",function(){
                if(localStorage.getItem('buy['+i+']')==null)
                    localStorage.setItem('buy['+i+']',1)
                else 
                    localStorage.setItem('buy['+i+']',parseInt(localStorage.getItem('buy['+i+']'))+1)
                updateStorage(i)

            })
            minusbtns[i].addEventListener("click",function(){
                if(parseInt(localStorage.getItem('buy['+i+']'))-1<0 || localStorage.getItem('buy['+i+']')==null){
                    localStorage.setItem('buy['+i+']',0)
                    alert("商品数量不能小于0")
                }
                else
                    localStorage.setItem('buy['+i+']',parseInt(localStorage.getItem('buy['+i+']'))-1)
                updateStorage(i)
            })
        }



        
    
    </script>
</body>
</html>